{"ast":null,"code":"var _jsxFileName = \"/Users/rodericandrews/Factory-ai/waterfall-app/client/src/components/CIA/CIAWizard.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"../../utils/axios\";\nimport { CheckCircle2, AlertCircle, Building2, Globe, FileText, Download, FileSpreadsheet, Database, Loader2 } from \"lucide-react\";\n\n// Import shadcn/ui components\nimport { Button } from \"../ui/button\";\nimport { Input } from \"../ui/input\";\nimport { Label } from \"../ui/label\";\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent, CardFooter } from \"../ui/card\";\n\n// Utility functions\nimport { cn } from \"../../lib/utils\";\n\n/**\n * CIA Wizard - Simplified form for gathering company intelligence data\n * Collects minimal information needed to generate a comprehensive marketing intelligence report\n */\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CIAWizard = () => {\n  _s();\n  // Form state\n  const [formData, setFormData] = useState({\n    companyName: \"\",\n    websiteUrl: \"\",\n    keyPersonOfInfluence: \"\",\n    primaryKeyword: \"\"\n  });\n\n  // Submission state\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isSubmitted, setIsSubmitted] = useState(false);\n  const [errors, setErrors] = useState({});\n\n  // Report state\n  const [reportId, setReportId] = useState(null);\n  const [reportStatus, setReportStatus] = useState(\"idle\"); // idle, processing, completed, failed\n  const [reportProgress, setReportProgress] = useState(0);\n  const [currentPhase, setCurrentPhase] = useState(0);\n  const [phaseDetails, setPhaseDetails] = useState([]);\n  const [reportResults, setReportResults] = useState(null);\n  const [exportLoading, setExportLoading] = useState({\n    pdf: false,\n    sheets: false,\n    notion: false\n  });\n  const [exportError, setExportError] = useState(null);\n\n  // CIA workflow phases\n  const phases = [{\n    id: 1,\n    name: \"Business Intelligence\",\n    description: \"Analyzing company data and market position\"\n  }, {\n    id: 2,\n    name: \"SEO & Social Intelligence\",\n    description: \"Researching keywords and competitive landscape\"\n  }, {\n    id: 3,\n    name: \"Strategic Synthesis\",\n    description: \"Combining insights for strategic recommendations\"\n  }, {\n    id: 4,\n    name: \"Golden Hippo Offer\",\n    description: \"Developing tiered pricing and value stacks\"\n  }, {\n    id: 5,\n    name: \"Convergence Blender\",\n    description: \"Creating 12-week content calendar\"\n  }, {\n    id: 6,\n    name: \"Master Content Bible\",\n    description: \"Finalizing implementation roadmap\"\n  }];\n\n  // Handle input changes\n  const handleChange = (field, value) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n\n    // Clear error when field is updated\n    if (errors[field]) {\n      setErrors(prev => {\n        const newErrors = {\n          ...prev\n        };\n        delete newErrors[field];\n        return newErrors;\n      });\n    }\n  };\n\n  // Validate form\n  const validateForm = () => {\n    const newErrors = {};\n    if (!formData.companyName.trim()) {\n      newErrors.companyName = \"Company name is required\";\n    }\n    if (!formData.websiteUrl.trim()) {\n      newErrors.websiteUrl = \"Website URL is required\";\n    } else {\n      // Enhanced URL validation regex\n      // Checks for proper protocol, valid domain structure, and common TLDs\n      const urlRegex = /^(https?:\\/\\/)?(www\\.)?([a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}(\\/[a-zA-Z0-9-._~:/?#[\\]@!$&'()*+,;=]*)?$/;\n      if (!urlRegex.test(formData.websiteUrl)) {\n        newErrors.websiteUrl = \"Please enter a valid URL (e.g., https://example.com)\";\n      }\n    }\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  // Submit form\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!validateForm()) {\n      return;\n    }\n    setIsSubmitting(true);\n    try {\n      // Create a new CIA report\n      const response = await axios.post(\"/cia/reports\", {\n        name: `${formData.companyName} Intelligence Report`,\n        description: `CIA report for ${formData.companyName}`,\n        initialData: {\n          companyName: formData.companyName,\n          websiteUrl: formData.websiteUrl.startsWith('http') ? formData.websiteUrl : `https://${formData.websiteUrl}`,\n          keyPersonOfInfluence: formData.keyPersonOfInfluence ? {\n            name: formData.keyPersonOfInfluence,\n            role: \"Key Person of Influence\"\n          } : {},\n          primaryKeyword: formData.primaryKeyword\n        }\n      });\n\n      // Get the report ID\n      const {\n        id\n      } = response.data.report;\n      setReportId(id);\n      setIsSubmitted(true);\n      setReportStatus(\"processing\");\n\n      // Begin polling for status updates\n      startStatusPolling(id);\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error(\"Error submitting CIA report:\", error);\n      setErrors({\n        submit: ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || \"Failed to submit report. Please try again.\"\n      });\n      setIsSubmitting(false);\n    }\n  };\n\n  // Poll for report status updates\n  const startStatusPolling = id => {\n    const pollInterval = setInterval(async () => {\n      try {\n        const response = await axios.get(`/cia/reports/${id}/status`);\n        const {\n          status,\n          progress,\n          currentPhase,\n          phaseProgress,\n          errors: reportErrors\n        } = response.data;\n        setReportStatus(status);\n        setReportProgress(progress);\n        if (currentPhase) {\n          setCurrentPhase(currentPhase);\n\n          // Update phase details â€“ deterministic single pass\n          setPhaseDetails(prev => {\n            const updated = [...prev];\n\n            // Ensure array has six placeholder objects\n            for (let i = 0; i < phases.length; i++) {\n              if (!updated[i]) {\n                updated[i] = {\n                  id: i + 1,\n                  progress: 0,\n                  status: \"pending\"\n                };\n              }\n            }\n\n            // Mark completed phases\n            for (let i = 0; i < currentPhase - 1; i++) {\n              updated[i] = {\n                ...updated[i],\n                progress: 100,\n                status: \"completed\"\n              };\n            }\n\n            // Update current phase\n            const idx = currentPhase - 1;\n            updated[idx] = {\n              ...updated[idx],\n              progress: phaseProgress !== null && phaseProgress !== void 0 ? phaseProgress : 0,\n              status: phaseProgress >= 100 ? \"completed\" : \"processing\"\n            };\n\n            // If failed, reset subsequent phases to pending\n            if (status === \"failed\") {\n              for (let i = currentPhase; i < phases.length; i++) {\n                updated[i] = {\n                  ...updated[i],\n                  progress: 0,\n                  status: \"pending\"\n                };\n              }\n            }\n            return updated;\n          });\n        }\n\n        // If completed or failed, stop polling and fetch results\n        if (status === \"completed\" || status === \"failed\") {\n          clearInterval(pollInterval);\n          if (status === \"completed\") {\n            fetchReportResults(id);\n          } else if (status === \"failed\" && reportErrors && reportErrors.length > 0) {\n            // Display the error messages from the report\n            setErrors({\n              report: reportErrors.map(err => `${err.stage}: ${err.message}`).join(\", \")\n            });\n          }\n        }\n      } catch (error) {\n        console.error(\"Error polling report status:\", error);\n        // Don't stop polling on error, just log it\n      }\n    }, 3000); // Poll every 3 seconds\n\n    // Clean up interval on component unmount\n    return () => clearInterval(pollInterval);\n  };\n\n  // Fetch report results\n  const fetchReportResults = async id => {\n    try {\n      const response = await axios.get(`/cia/reports/${id}`);\n      setReportResults(response.data);\n    } catch (error) {\n      console.error(\"Error fetching report results:\", error);\n      setErrors({\n        results: \"Failed to fetch report results. Please try refreshing the page.\"\n      });\n    }\n  };\n\n  // Check if all phases are complete\n  const areAllPhasesComplete = () => {\n    // If we have fewer phase details than phases, some are missing\n    if (phaseDetails.length < phases.length) return false;\n\n    // Check if all phases have 100% progress\n    return phaseDetails.every(phase => phase && phase.progress === 100);\n  };\n\n  // Export report\n  const exportReport = async format => {\n    setExportLoading(prev => ({\n      ...prev,\n      [format]: true\n    }));\n    setExportError(null);\n    try {\n      console.log(`Starting export for format: ${format}, reportId: ${reportId}`);\n      const response = await axios.post(`/cia/reports/${reportId}/export`, {\n        format\n      });\n      if (!response.data || !response.data.exportUrl) {\n        throw new Error(`Export response missing URL for ${format} format`);\n      }\n      console.log(`Export successful, received URL: ${response.data.exportUrl}`);\n\n      // Construct the full URL if it's a relative path\n      let fullUrl = response.data.exportUrl;\n      if (fullUrl.startsWith('/')) {\n        // Get the base URL from the current window location\n        const baseUrl = `${window.location.protocol}//${window.location.host}`;\n        fullUrl = `${baseUrl}${fullUrl}`;\n        console.log(`Constructed full URL: ${fullUrl}`);\n      }\n\n      // Handle different export formats\n      if (format === \"pdf\") {\n        // For PDF, create a download link\n        console.log(`Creating download link for PDF: ${fullUrl}`);\n        const link = document.createElement(\"a\");\n        link.href = fullUrl;\n        link.download = `${formData.companyName}_CIA_Report.pdf`;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n      } else {\n        // For other formats, open in new tab\n        console.log(`Opening URL in new tab: ${fullUrl}`);\n        window.open(fullUrl, \"_blank\");\n      }\n    } catch (error) {\n      console.error(`Error exporting report as ${format}:`, error);\n\n      // Provide more detailed error information\n      let errorMessage = `Failed to export as ${format}. `;\n      if (error.response) {\n        var _error$response$data2;\n        // The request was made and the server responded with a status code\n        // that falls out of the range of 2xx\n        const statusCode = error.response.status;\n        const serverMessage = ((_error$response$data2 = error.response.data) === null || _error$response$data2 === void 0 ? void 0 : _error$response$data2.message) || 'Unknown server error';\n        errorMessage += `Server responded with status ${statusCode}: ${serverMessage}`;\n        console.error('Export error response:', error.response.data);\n      } else if (error.request) {\n        // The request was made but no response was received\n        errorMessage += 'No response received from server. Please check your connection.';\n      } else {\n        // Something happened in setting up the request that triggered an Error\n        errorMessage += error.message || 'Unknown error occurred';\n      }\n      setExportError(errorMessage);\n    } finally {\n      setExportLoading(prev => ({\n        ...prev,\n        [format]: false\n      }));\n    }\n  };\n\n  // Render form\n  const renderForm = () => /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"company-name\",\n          children: \"Company Name *\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"company-name\",\n          value: formData.companyName,\n          onChange: e => handleChange(\"companyName\", e.target.value),\n          placeholder: \"e.g. Acme Corporation\",\n          className: errors.companyName ? \"border-destructive\" : \"\",\n          disabled: isSubmitting\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 11\n        }, this), errors.companyName && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-destructive\",\n          children: errors.companyName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"website-url\",\n          children: \"Website URL *\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"website-url\",\n          value: formData.websiteUrl,\n          onChange: e => handleChange(\"websiteUrl\", e.target.value),\n          placeholder: \"e.g. https://www.example.com\",\n          className: errors.websiteUrl ? \"border-destructive\" : \"\",\n          disabled: isSubmitting\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 11\n        }, this), errors.websiteUrl && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-destructive\",\n          children: errors.websiteUrl\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"kpoi\",\n          children: \"Key Person of Influence (Optional)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"kpoi\",\n          value: formData.keyPersonOfInfluence,\n          onChange: e => handleChange(\"keyPersonOfInfluence\", e.target.value),\n          placeholder: \"e.g. John Smith, CEO\",\n          disabled: isSubmitting\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-muted-foreground\",\n          children: \"The main person associated with your brand\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"primary-keyword\",\n          children: \"Primary Keyword (Optional)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"primary-keyword\",\n          value: formData.primaryKeyword,\n          onChange: e => handleChange(\"primaryKeyword\", e.target.value),\n          placeholder: \"e.g. digital marketing services\",\n          disabled: isSubmitting\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-muted-foreground\",\n          children: \"Main keyword you want to rank for\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 9\n      }, this), errors.submit && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-3 bg-destructive/10 border border-destructive rounded-md\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-destructive flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n            className: \"h-4 w-4 mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 373,\n            columnNumber: 15\n          }, this), errors.submit]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-6\",\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        type: \"submit\",\n        className: \"w-full\",\n        disabled: isSubmitting,\n        children: isSubmitting ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Loader2, {\n            className: \"mr-2 h-4 w-4 animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 15\n          }, this), \"Submitting...\"]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [\"Generate CIA Report\", /*#__PURE__*/_jsxDEV(FileText, {\n            className: \"ml-2 h-4 w-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 394,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 314,\n    columnNumber: 5\n  }, this);\n\n  // Render progress\n  const renderProgress = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-medium\",\n        children: reportStatus === \"completed\" ? \"Your CIA Report is Ready!\" : reportStatus === \"failed\" ? \"Report Generation Failed\" : \"Generating Your CIA Report...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-sm text-muted-foreground\",\n        children: reportStatus === \"completed\" ? \"Your comprehensive marketing intelligence report has been generated. You can now export it in various formats.\" : reportStatus === \"failed\" ? \"There was an error generating your report. Please check the error details below.\" : \"Our AI is analyzing your company data across all 6 phases. This may take a few minutes.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 405,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-between text-sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Overall Progress\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [reportProgress, \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full bg-muted rounded-full h-2.5\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: cn(\"h-2.5 rounded-full\", reportStatus === \"completed\" ? \"bg-success\" : reportStatus === \"failed\" ? \"bg-destructive\" : \"bg-primary\"),\n          style: {\n            width: `${reportProgress}%`\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"text-sm font-medium\",\n        children: \"CIA Workflow Phases\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 442,\n        columnNumber: 9\n      }, this), phases.map((phase, index) => {\n        const phaseDetail = phaseDetails[index] || {\n          progress: 0,\n          status: index === currentPhase - 1 ? \"processing\" : \"pending\"\n        };\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-1\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between text-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"flex items-center\",\n              children: [phaseDetail.status === \"completed\" ? /*#__PURE__*/_jsxDEV(CheckCircle2, {\n                className: \"h-4 w-4 text-success mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 455,\n                columnNumber: 21\n              }, this) : phaseDetail.status === \"processing\" ? /*#__PURE__*/_jsxDEV(Loader2, {\n                className: \"h-4 w-4 text-primary mr-2 animate-spin\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 457,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-4 w-4 rounded-full border border-muted-foreground mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 459,\n                columnNumber: 21\n              }, this), phase.name]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 453,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [phaseDetail.progress, \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 463,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-full bg-muted rounded-full h-1.5\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: cn(\"h-1.5 rounded-full\", phaseDetail.status === \"completed\" ? \"bg-success\" : reportStatus === \"failed\" && index >= currentPhase ? \"bg-muted\" : \"bg-primary\"),\n              style: {\n                width: `${phaseDetail.progress}%`\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 466,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 465,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-muted-foreground\",\n            children: phase.description\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 475,\n            columnNumber: 15\n          }, this)]\n        }, phase.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 13\n        }, this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 441,\n      columnNumber: 7\n    }, this), reportStatus === \"failed\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-4 bg-destructive/10 border border-destructive rounded-md\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-start space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n          className: \"h-5 w-5 text-destructive mt-0.5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 485,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n            className: \"font-medium text-destructive\",\n            children: \"Report Generation Failed\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 487,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-muted-foreground mt-1\",\n            children: errors.report ? errors.report : \"There was an error generating your CIA report. Please try again or contact support for assistance.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 488,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"outline\",\n            className: \"mt-4\",\n            onClick: () => {\n              setIsSubmitted(false);\n              setReportStatus(\"idle\");\n              setReportProgress(0);\n              setCurrentPhase(0);\n              setPhaseDetails([]);\n              setReportResults(null);\n              setErrors({});\n            },\n            children: \"Try Again\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 491,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 483,\n      columnNumber: 9\n    }, this), reportStatus === \"completed\" && areAllPhasesComplete() && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4 pt-4 border-t\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"text-sm font-medium\",\n        children: \"Export Options\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 514,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col sm:flex-row gap-3\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outline\",\n          onClick: () => exportReport(\"pdf\"),\n          disabled: exportLoading.pdf,\n          className: \"flex-1\",\n          children: [exportLoading.pdf ? /*#__PURE__*/_jsxDEV(Loader2, {\n            className: \"mr-2 h-4 w-4 animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 524,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(Download, {\n            className: \"mr-2 h-4 w-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 526,\n            columnNumber: 17\n          }, this), \"Export as PDF\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 517,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outline\",\n          onClick: () => exportReport(\"google_sheets\"),\n          disabled: exportLoading.sheets,\n          className: \"flex-1\",\n          children: [exportLoading.sheets ? /*#__PURE__*/_jsxDEV(Loader2, {\n            className: \"mr-2 h-4 w-4 animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 538,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(FileSpreadsheet, {\n            className: \"mr-2 h-4 w-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 540,\n            columnNumber: 17\n          }, this), \"Export to Google Sheets\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outline\",\n          onClick: () => exportReport(\"notion\"),\n          disabled: exportLoading.notion,\n          className: \"flex-1\",\n          children: [exportLoading.notion ? /*#__PURE__*/_jsxDEV(Loader2, {\n            className: \"mr-2 h-4 w-4 animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 552,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(Database, {\n            className: \"mr-2 h-4 w-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 554,\n            columnNumber: 17\n          }, this), \"Export to Notion\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 545,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 516,\n        columnNumber: 11\n      }, this), exportError && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-3 bg-destructive/10 border border-destructive rounded-md\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-destructive flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n            className: \"h-4 w-4 mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 563,\n            columnNumber: 17\n          }, this), exportError]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 562,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 561,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 513,\n      columnNumber: 9\n    }, this), reportStatus === \"completed\" && reportResults && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4 pt-4 border-t\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"text-sm font-medium\",\n        children: \"Report Preview\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 574,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"border rounded-md p-4 bg-muted/50\",\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \"font-medium\",\n          children: reportResults.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 578,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-muted-foreground mt-1\",\n          children: reportResults.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 13\n        }, this), reportResults.phases && reportResults.phases.map(phase => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n            className: \"text-sm font-medium\",\n            children: phase.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 584,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-muted-foreground\",\n            children: phase.summary\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 585,\n            columnNumber: 17\n          }, this)]\n        }, phase.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 583,\n          columnNumber: 15\n        }, this)), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm mt-4\",\n          children: \"For the complete report with all insights and recommendations, please use one of the export options above.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 577,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 573,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 404,\n    columnNumber: 5\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mx-auto py-8 px-4 md:px-6\",\n    children: /*#__PURE__*/_jsxDEV(Card, {\n      className: \"w-full max-w-4xl mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n        children: [/*#__PURE__*/_jsxDEV(CardTitle, {\n          className: \"flex items-center\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"gradient-text\",\n            children: \"CIA Wizard\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 603,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 602,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CardDescription, {\n          children: \"The Colossal Intelligence Arsenal will gather and process data to create your \\\"Master Content Bible\\\"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 605,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 601,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n        children: isSubmitted ? renderProgress() : renderForm()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 610,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CardFooter, {\n        className: \"flex justify-between\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-muted-foreground\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(Building2, {\n              className: \"h-3 w-3 mr-1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 617,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: formData.companyName || \"Your Company\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 618,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 616,\n            columnNumber: 13\n          }, this), formData.websiteUrl && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center mt-1\",\n            children: [/*#__PURE__*/_jsxDEV(Globe, {\n              className: \"h-3 w-3 mr-1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 622,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: formData.websiteUrl\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 623,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 621,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 615,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 614,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 600,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 599,\n    columnNumber: 5\n  }, this);\n};\n_s(CIAWizard, \"Sals+1X23eLodZG/F9kedxnuYRY=\");\n_c = CIAWizard;\nexport default CIAWizard;\nvar _c;\n$RefreshReg$(_c, \"CIAWizard\");","map":{"version":3,"names":["React","useState","useEffect","axios","CheckCircle2","AlertCircle","Building2","Globe","FileText","Download","FileSpreadsheet","Database","Loader2","Button","Input","Label","Card","CardHeader","CardTitle","CardDescription","CardContent","CardFooter","cn","jsxDEV","_jsxDEV","Fragment","_Fragment","CIAWizard","_s","formData","setFormData","companyName","websiteUrl","keyPersonOfInfluence","primaryKeyword","isSubmitting","setIsSubmitting","isSubmitted","setIsSubmitted","errors","setErrors","reportId","setReportId","reportStatus","setReportStatus","reportProgress","setReportProgress","currentPhase","setCurrentPhase","phaseDetails","setPhaseDetails","reportResults","setReportResults","exportLoading","setExportLoading","pdf","sheets","notion","exportError","setExportError","phases","id","name","description","handleChange","field","value","prev","newErrors","validateForm","trim","urlRegex","test","Object","keys","length","handleSubmit","e","preventDefault","response","post","initialData","startsWith","role","data","report","startStatusPolling","error","_error$response","_error$response$data","console","submit","message","pollInterval","setInterval","get","status","progress","phaseProgress","reportErrors","updated","i","idx","clearInterval","fetchReportResults","map","err","stage","join","results","areAllPhasesComplete","every","phase","exportReport","format","log","exportUrl","Error","fullUrl","baseUrl","window","location","protocol","host","link","document","createElement","href","download","body","appendChild","click","removeChild","open","errorMessage","_error$response$data2","statusCode","serverMessage","request","renderForm","onSubmit","children","className","htmlFor","fileName","_jsxFileName","lineNumber","columnNumber","onChange","target","placeholder","disabled","type","renderProgress","style","width","index","phaseDetail","variant","onClick","summary","_c","$RefreshReg$"],"sources":["/Users/rodericandrews/Factory-ai/waterfall-app/client/src/components/CIA/CIAWizard.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"../../utils/axios\";\nimport { \n  CheckCircle2, \n  AlertCircle, \n  Building2, \n  Globe,\n  FileText,\n  Download,\n  FileSpreadsheet,\n  Database,\n  Loader2\n} from \"lucide-react\";\n\n// Import shadcn/ui components\nimport { Button } from \"../ui/button\";\nimport { Input } from \"../ui/input\";\nimport { Label } from \"../ui/label\";\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent, CardFooter } from \"../ui/card\";\n\n// Utility functions\nimport { cn } from \"../../lib/utils\";\n\n/**\n * CIA Wizard - Simplified form for gathering company intelligence data\n * Collects minimal information needed to generate a comprehensive marketing intelligence report\n */\nconst CIAWizard = () => {\n  // Form state\n  const [formData, setFormData] = useState({\n    companyName: \"\",\n    websiteUrl: \"\",\n    keyPersonOfInfluence: \"\",\n    primaryKeyword: \"\"\n  });\n  \n  // Submission state\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isSubmitted, setIsSubmitted] = useState(false);\n  const [errors, setErrors] = useState({});\n  \n  // Report state\n  const [reportId, setReportId] = useState(null);\n  const [reportStatus, setReportStatus] = useState(\"idle\"); // idle, processing, completed, failed\n  const [reportProgress, setReportProgress] = useState(0);\n  const [currentPhase, setCurrentPhase] = useState(0);\n  const [phaseDetails, setPhaseDetails] = useState([]);\n  const [reportResults, setReportResults] = useState(null);\n  const [exportLoading, setExportLoading] = useState({\n    pdf: false,\n    sheets: false,\n    notion: false\n  });\n  const [exportError, setExportError] = useState(null);\n\n  // CIA workflow phases\n  const phases = [\n    { id: 1, name: \"Business Intelligence\", description: \"Analyzing company data and market position\" },\n    { id: 2, name: \"SEO & Social Intelligence\", description: \"Researching keywords and competitive landscape\" },\n    { id: 3, name: \"Strategic Synthesis\", description: \"Combining insights for strategic recommendations\" },\n    { id: 4, name: \"Golden Hippo Offer\", description: \"Developing tiered pricing and value stacks\" },\n    { id: 5, name: \"Convergence Blender\", description: \"Creating 12-week content calendar\" },\n    { id: 6, name: \"Master Content Bible\", description: \"Finalizing implementation roadmap\" }\n  ];\n\n  // Handle input changes\n  const handleChange = (field, value) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n    \n    // Clear error when field is updated\n    if (errors[field]) {\n      setErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[field];\n        return newErrors;\n      });\n    }\n  };\n\n  // Validate form\n  const validateForm = () => {\n    const newErrors = {};\n    \n    if (!formData.companyName.trim()) {\n      newErrors.companyName = \"Company name is required\";\n    }\n    \n    if (!formData.websiteUrl.trim()) {\n      newErrors.websiteUrl = \"Website URL is required\";\n    } else {\n      // Enhanced URL validation regex\n      // Checks for proper protocol, valid domain structure, and common TLDs\n      const urlRegex = /^(https?:\\/\\/)?(www\\.)?([a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}(\\/[a-zA-Z0-9-._~:/?#[\\]@!$&'()*+,;=]*)?$/;\n      if (!urlRegex.test(formData.websiteUrl)) {\n        newErrors.websiteUrl = \"Please enter a valid URL (e.g., https://example.com)\";\n      }\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  // Submit form\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n    \n    setIsSubmitting(true);\n    \n    try {\n      // Create a new CIA report\n      const response = await axios.post(\"/cia/reports\", {\n        name: `${formData.companyName} Intelligence Report`,\n        description: `CIA report for ${formData.companyName}`,\n        initialData: {\n          companyName: formData.companyName,\n          websiteUrl: formData.websiteUrl.startsWith('http') ? formData.websiteUrl : `https://${formData.websiteUrl}`,\n          keyPersonOfInfluence: formData.keyPersonOfInfluence ? {\n            name: formData.keyPersonOfInfluence,\n            role: \"Key Person of Influence\"\n          } : {},\n          primaryKeyword: formData.primaryKeyword\n        }\n      });\n      \n      // Get the report ID\n      const { id } = response.data.report;\n      setReportId(id);\n      setIsSubmitted(true);\n      setReportStatus(\"processing\");\n      \n      // Begin polling for status updates\n      startStatusPolling(id);\n    } catch (error) {\n      console.error(\"Error submitting CIA report:\", error);\n      setErrors({\n        submit: error.response?.data?.message || \"Failed to submit report. Please try again.\"\n      });\n      setIsSubmitting(false);\n    }\n  };\n\n  // Poll for report status updates\n  const startStatusPolling = (id) => {\n    const pollInterval = setInterval(async () => {\n      try {\n        const response = await axios.get(`/cia/reports/${id}/status`);\n        const { status, progress, currentPhase, phaseProgress, errors: reportErrors } = response.data;\n\n        setReportStatus(status);\n        setReportProgress(progress);\n        \n        if (currentPhase) {\n          setCurrentPhase(currentPhase);\n          \n          // Update phase details â€“ deterministic single pass\n          setPhaseDetails(prev => {\n            const updated = [...prev];\n\n            // Ensure array has six placeholder objects\n            for (let i = 0; i < phases.length; i++) {\n              if (!updated[i]) {\n                updated[i] = { id: i + 1, progress: 0, status: \"pending\" };\n              }\n            }\n\n            // Mark completed phases\n            for (let i = 0; i < currentPhase - 1; i++) {\n              updated[i] = { ...updated[i], progress: 100, status: \"completed\" };\n            }\n\n            // Update current phase\n            const idx = currentPhase - 1;\n            updated[idx] = {\n              ...updated[idx],\n              progress: phaseProgress ?? 0,\n              status: phaseProgress >= 100 ? \"completed\" : \"processing\"\n            };\n\n            // If failed, reset subsequent phases to pending\n            if (status === \"failed\") {\n              for (let i = currentPhase; i < phases.length; i++) {\n                updated[i] = { ...updated[i], progress: 0, status: \"pending\" };\n              }\n            }\n\n            return updated;\n          });\n        }\n        \n        // If completed or failed, stop polling and fetch results\n        if (status === \"completed\" || status === \"failed\") {\n          clearInterval(pollInterval);\n          \n          if (status === \"completed\") {\n            fetchReportResults(id);\n          } else if (status === \"failed\" && reportErrors && reportErrors.length > 0) {\n            // Display the error messages from the report\n            setErrors({\n              report: reportErrors.map(err => `${err.stage}: ${err.message}`).join(\", \")\n            });\n          }\n        }\n      } catch (error) {\n        console.error(\"Error polling report status:\", error);\n        // Don't stop polling on error, just log it\n      }\n    }, 3000); // Poll every 3 seconds\n    \n    // Clean up interval on component unmount\n    return () => clearInterval(pollInterval);\n  };\n\n  // Fetch report results\n  const fetchReportResults = async (id) => {\n    try {\n      const response = await axios.get(`/cia/reports/${id}`);\n      setReportResults(response.data);\n    } catch (error) {\n      console.error(\"Error fetching report results:\", error);\n      setErrors({\n        results: \"Failed to fetch report results. Please try refreshing the page.\"\n      });\n    }\n  };\n\n  // Check if all phases are complete\n  const areAllPhasesComplete = () => {\n    // If we have fewer phase details than phases, some are missing\n    if (phaseDetails.length < phases.length) return false;\n    \n    // Check if all phases have 100% progress\n    return phaseDetails.every(phase => phase && phase.progress === 100);\n  };\n\n  // Export report\n  const exportReport = async (format) => {\n    setExportLoading(prev => ({ ...prev, [format]: true }));\n    setExportError(null);\n    \n    try {\n      console.log(`Starting export for format: ${format}, reportId: ${reportId}`);\n      \n      const response = await axios.post(`/cia/reports/${reportId}/export`, {\n        format\n      });\n      \n      if (!response.data || !response.data.exportUrl) {\n        throw new Error(`Export response missing URL for ${format} format`);\n      }\n      \n      console.log(`Export successful, received URL: ${response.data.exportUrl}`);\n      \n      // Construct the full URL if it's a relative path\n      let fullUrl = response.data.exportUrl;\n      if (fullUrl.startsWith('/')) {\n        // Get the base URL from the current window location\n        const baseUrl = `${window.location.protocol}//${window.location.host}`;\n        fullUrl = `${baseUrl}${fullUrl}`;\n        console.log(`Constructed full URL: ${fullUrl}`);\n      }\n      \n      // Handle different export formats\n      if (format === \"pdf\") {\n        // For PDF, create a download link\n        console.log(`Creating download link for PDF: ${fullUrl}`);\n        const link = document.createElement(\"a\");\n        link.href = fullUrl;\n        link.download = `${formData.companyName}_CIA_Report.pdf`;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n      } else {\n        // For other formats, open in new tab\n        console.log(`Opening URL in new tab: ${fullUrl}`);\n        window.open(fullUrl, \"_blank\");\n      }\n    } catch (error) {\n      console.error(`Error exporting report as ${format}:`, error);\n      \n      // Provide more detailed error information\n      let errorMessage = `Failed to export as ${format}. `;\n      \n      if (error.response) {\n        // The request was made and the server responded with a status code\n        // that falls out of the range of 2xx\n        const statusCode = error.response.status;\n        const serverMessage = error.response.data?.message || 'Unknown server error';\n        \n        errorMessage += `Server responded with status ${statusCode}: ${serverMessage}`;\n        console.error('Export error response:', error.response.data);\n      } else if (error.request) {\n        // The request was made but no response was received\n        errorMessage += 'No response received from server. Please check your connection.';\n      } else {\n        // Something happened in setting up the request that triggered an Error\n        errorMessage += error.message || 'Unknown error occurred';\n      }\n      \n      setExportError(errorMessage);\n    } finally {\n      setExportLoading(prev => ({ ...prev, [format]: false }));\n    }\n  };\n\n  // Render form\n  const renderForm = () => (\n    <form onSubmit={handleSubmit}>\n      <div className=\"space-y-4\">\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"company-name\">Company Name *</Label>\n          <Input\n            id=\"company-name\"\n            value={formData.companyName}\n            onChange={(e) => handleChange(\"companyName\", e.target.value)}\n            placeholder=\"e.g. Acme Corporation\"\n            className={errors.companyName ? \"border-destructive\" : \"\"}\n            disabled={isSubmitting}\n          />\n          {errors.companyName && (\n            <p className=\"text-sm text-destructive\">{errors.companyName}</p>\n          )}\n        </div>\n        \n        <div className=\"space-y-2\">\n          <Label htmlFor=\"website-url\">Website URL *</Label>\n          <Input\n            id=\"website-url\"\n            value={formData.websiteUrl}\n            onChange={(e) => handleChange(\"websiteUrl\", e.target.value)}\n            placeholder=\"e.g. https://www.example.com\"\n            className={errors.websiteUrl ? \"border-destructive\" : \"\"}\n            disabled={isSubmitting}\n          />\n          {errors.websiteUrl && (\n            <p className=\"text-sm text-destructive\">{errors.websiteUrl}</p>\n          )}\n        </div>\n        \n        <div className=\"space-y-2\">\n          <Label htmlFor=\"kpoi\">Key Person of Influence (Optional)</Label>\n          <Input\n            id=\"kpoi\"\n            value={formData.keyPersonOfInfluence}\n            onChange={(e) => handleChange(\"keyPersonOfInfluence\", e.target.value)}\n            placeholder=\"e.g. John Smith, CEO\"\n            disabled={isSubmitting}\n          />\n          <p className=\"text-xs text-muted-foreground\">The main person associated with your brand</p>\n        </div>\n        \n        <div className=\"space-y-2\">\n          <Label htmlFor=\"primary-keyword\">Primary Keyword (Optional)</Label>\n          <Input\n            id=\"primary-keyword\"\n            value={formData.primaryKeyword}\n            onChange={(e) => handleChange(\"primaryKeyword\", e.target.value)}\n            placeholder=\"e.g. digital marketing services\"\n            disabled={isSubmitting}\n          />\n          <p className=\"text-xs text-muted-foreground\">Main keyword you want to rank for</p>\n        </div>\n        \n        {errors.submit && (\n          <div className=\"p-3 bg-destructive/10 border border-destructive rounded-md\">\n            <p className=\"text-sm text-destructive flex items-center\">\n              <AlertCircle className=\"h-4 w-4 mr-2\" />\n              {errors.submit}\n            </p>\n          </div>\n        )}\n      </div>\n      \n      <div className=\"mt-6\">\n        <Button \n          type=\"submit\" \n          className=\"w-full\" \n          disabled={isSubmitting}\n        >\n          {isSubmitting ? (\n            <>\n              <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n              Submitting...\n            </>\n          ) : (\n            <>\n              Generate CIA Report\n              <FileText className=\"ml-2 h-4 w-4\" />\n            </>\n          )}\n        </Button>\n      </div>\n    </form>\n  );\n\n  // Render progress\n  const renderProgress = () => (\n    <div className=\"space-y-6\">\n      <div className=\"space-y-2\">\n        <h3 className=\"text-lg font-medium\">\n          {reportStatus === \"completed\" \n            ? \"Your CIA Report is Ready!\" \n            : reportStatus === \"failed\"\n            ? \"Report Generation Failed\"\n            : \"Generating Your CIA Report...\"}\n        </h3>\n        <p className=\"text-sm text-muted-foreground\">\n          {reportStatus === \"completed\"\n            ? \"Your comprehensive marketing intelligence report has been generated. You can now export it in various formats.\"\n            : reportStatus === \"failed\"\n            ? \"There was an error generating your report. Please check the error details below.\"\n            : \"Our AI is analyzing your company data across all 6 phases. This may take a few minutes.\"}\n        </p>\n      </div>\n      \n      {/* Overall progress */}\n      <div className=\"space-y-2\">\n        <div className=\"flex justify-between text-sm\">\n          <span>Overall Progress</span>\n          <span>{reportProgress}%</span>\n        </div>\n        <div className=\"w-full bg-muted rounded-full h-2.5\">\n          <div\n            className={cn(\n              \"h-2.5 rounded-full\",\n              reportStatus === \"completed\" ? \"bg-success\" : \n              reportStatus === \"failed\" ? \"bg-destructive\" : \"bg-primary\"\n            )}\n            style={{ width: `${reportProgress}%` }}\n          ></div>\n        </div>\n      </div>\n      \n      {/* Phase progress */}\n      <div className=\"space-y-4\">\n        <h4 className=\"text-sm font-medium\">CIA Workflow Phases</h4>\n        \n        {phases.map((phase, index) => {\n          const phaseDetail = phaseDetails[index] || { \n            progress: 0, \n            status: index === currentPhase - 1 ? \"processing\" : \"pending\" \n          };\n          \n          return (\n            <div key={phase.id} className=\"space-y-1\">\n              <div className=\"flex justify-between text-sm\">\n                <span className=\"flex items-center\">\n                  {phaseDetail.status === \"completed\" ? (\n                    <CheckCircle2 className=\"h-4 w-4 text-success mr-2\" />\n                  ) : phaseDetail.status === \"processing\" ? (\n                    <Loader2 className=\"h-4 w-4 text-primary mr-2 animate-spin\" />\n                  ) : (\n                    <div className=\"h-4 w-4 rounded-full border border-muted-foreground mr-2\" />\n                  )}\n                  {phase.name}\n                </span>\n                <span>{phaseDetail.progress}%</span>\n              </div>\n              <div className=\"w-full bg-muted rounded-full h-1.5\">\n                <div\n                  className={cn(\n                    \"h-1.5 rounded-full\",\n                    phaseDetail.status === \"completed\" ? \"bg-success\" : \n                    reportStatus === \"failed\" && index >= currentPhase ? \"bg-muted\" : \"bg-primary\"\n                  )}\n                  style={{ width: `${phaseDetail.progress}%` }}\n                ></div>\n              </div>\n              <p className=\"text-xs text-muted-foreground\">{phase.description}</p>\n            </div>\n          );\n        })}\n      </div>\n      \n      {/* Error message (visible when failed) */}\n      {reportStatus === \"failed\" && (\n        <div className=\"p-4 bg-destructive/10 border border-destructive rounded-md\">\n          <div className=\"flex items-start space-x-2\">\n            <AlertCircle className=\"h-5 w-5 text-destructive mt-0.5\" />\n            <div>\n              <h5 className=\"font-medium text-destructive\">Report Generation Failed</h5>\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                {errors.report ? errors.report : \"There was an error generating your CIA report. Please try again or contact support for assistance.\"}\n              </p>\n              <Button \n                variant=\"outline\" \n                className=\"mt-4\" \n                onClick={() => {\n                  setIsSubmitted(false);\n                  setReportStatus(\"idle\");\n                  setReportProgress(0);\n                  setCurrentPhase(0);\n                  setPhaseDetails([]);\n                  setReportResults(null);\n                  setErrors({});\n                }}\n              >\n                Try Again\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Export options (visible when completed AND all phases are at 100%) */}\n      {reportStatus === \"completed\" && areAllPhasesComplete() && (\n        <div className=\"space-y-4 pt-4 border-t\">\n          <h4 className=\"text-sm font-medium\">Export Options</h4>\n          \n          <div className=\"flex flex-col sm:flex-row gap-3\">\n            <Button \n              variant=\"outline\" \n              onClick={() => exportReport(\"pdf\")}\n              disabled={exportLoading.pdf}\n              className=\"flex-1\"\n            >\n              {exportLoading.pdf ? (\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n              ) : (\n                <Download className=\"mr-2 h-4 w-4\" />\n              )}\n              Export as PDF\n            </Button>\n            \n            <Button \n              variant=\"outline\" \n              onClick={() => exportReport(\"google_sheets\")}\n              disabled={exportLoading.sheets}\n              className=\"flex-1\"\n            >\n              {exportLoading.sheets ? (\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n              ) : (\n                <FileSpreadsheet className=\"mr-2 h-4 w-4\" />\n              )}\n              Export to Google Sheets\n            </Button>\n            \n            <Button \n              variant=\"outline\" \n              onClick={() => exportReport(\"notion\")}\n              disabled={exportLoading.notion}\n              className=\"flex-1\"\n            >\n              {exportLoading.notion ? (\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n              ) : (\n                <Database className=\"mr-2 h-4 w-4\" />\n              )}\n              Export to Notion\n            </Button>\n          </div>\n          \n          {exportError && (\n            <div className=\"p-3 bg-destructive/10 border border-destructive rounded-md\">\n              <p className=\"text-sm text-destructive flex items-center\">\n                <AlertCircle className=\"h-4 w-4 mr-2\" />\n                {exportError}\n              </p>\n            </div>\n          )}\n        </div>\n      )}\n      \n      {/* Results preview (visible when completed) */}\n      {reportStatus === \"completed\" && reportResults && (\n        <div className=\"space-y-4 pt-4 border-t\">\n          <h4 className=\"text-sm font-medium\">Report Preview</h4>\n          \n          {/* This would be expanded with actual report data visualization */}\n          <div className=\"border rounded-md p-4 bg-muted/50\">\n            <h5 className=\"font-medium\">{reportResults.name}</h5>\n            <p className=\"text-sm text-muted-foreground mt-1\">{reportResults.description}</p>\n            \n            {/* Example of displaying some report data */}\n            {reportResults.phases && reportResults.phases.map((phase) => (\n              <div key={phase.id} className=\"mt-4\">\n                <h6 className=\"text-sm font-medium\">{phase.name}</h6>\n                <p className=\"text-xs text-muted-foreground\">{phase.summary}</p>\n              </div>\n            ))}\n            \n            <p className=\"text-sm mt-4\">\n              For the complete report with all insights and recommendations, please use one of the export options above.\n            </p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n\n  return (\n    <div className=\"container mx-auto py-8 px-4 md:px-6\">\n      <Card className=\"w-full max-w-4xl mx-auto\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center\">\n            <span className=\"gradient-text\">CIA Wizard</span>\n          </CardTitle>\n          <CardDescription>\n            The Colossal Intelligence Arsenal will gather and process data to create your \"Master Content Bible\"\n          </CardDescription>\n        </CardHeader>\n        \n        <CardContent>\n          {isSubmitted ? renderProgress() : renderForm()}\n        </CardContent>\n        \n        <CardFooter className=\"flex justify-between\">\n          <div className=\"text-xs text-muted-foreground\">\n            <div className=\"flex items-center\">\n              <Building2 className=\"h-3 w-3 mr-1\" />\n              <span>{formData.companyName || \"Your Company\"}</span>\n            </div>\n            {formData.websiteUrl && (\n              <div className=\"flex items-center mt-1\">\n                <Globe className=\"h-3 w-3 mr-1\" />\n                <span>{formData.websiteUrl}</span>\n              </div>\n            )}\n          </div>\n        </CardFooter>\n      </Card>\n    </div>\n  );\n};\n\nexport default CIAWizard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}