{"ast":null,"code":"var _jsxFileName = \"/Users/rodericandrews/Factory-ai/waterfall-app/client/src/components/CIA/CIAWizard.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"../../utils/axios\";\nimport { CheckCircle2, AlertCircle, Building2, Globe, FileText, Download, FileSpreadsheet, Database, Loader2 } from \"lucide-react\";\n\n// Import shadcn/ui components\nimport { Button } from \"../ui/button\";\nimport { Input } from \"../ui/input\";\nimport { Label } from \"../ui/label\";\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent, CardFooter } from \"../ui/card\";\n\n// Utility functions\nimport { cn } from \"../../lib/utils\";\n\n/**\n * CIA Wizard - Simplified form for gathering company intelligence data\n * Collects minimal information needed to generate a comprehensive marketing intelligence report\n */\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CIAWizard = () => {\n  _s();\n  // Form state\n  const [formData, setFormData] = useState({\n    companyName: \"\",\n    websiteUrl: \"\",\n    keyPersonOfInfluence: \"\",\n    primaryKeyword: \"\"\n  });\n\n  // Submission state\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isSubmitted, setIsSubmitted] = useState(false);\n  const [errors, setErrors] = useState({});\n\n  // Report state\n  const [reportId, setReportId] = useState(null);\n  const [reportStatus, setReportStatus] = useState(\"idle\"); // idle, processing, completed, failed\n  const [reportProgress, setReportProgress] = useState(0);\n  const [currentPhase, setCurrentPhase] = useState(0);\n  const [phaseDetails, setPhaseDetails] = useState([]);\n  const [reportResults, setReportResults] = useState(null);\n  const [exportLoading, setExportLoading] = useState({\n    pdf: false,\n    sheets: false,\n    notion: false\n  });\n  const [exportError, setExportError] = useState(null);\n\n  // CIA workflow phases\n  const phases = [{\n    id: 1,\n    name: \"Business Intelligence\",\n    description: \"Analyzing company data and market position\"\n  }, {\n    id: 2,\n    name: \"SEO & Social Intelligence\",\n    description: \"Researching keywords and competitive landscape\"\n  }, {\n    id: 3,\n    name: \"Strategic Synthesis\",\n    description: \"Combining insights for strategic recommendations\"\n  }, {\n    id: 4,\n    name: \"Golden Hippo Offer\",\n    description: \"Developing tiered pricing and value stacks\"\n  }, {\n    id: 5,\n    name: \"Convergence Blender\",\n    description: \"Creating 12-week content calendar\"\n  }, {\n    id: 6,\n    name: \"Master Content Bible\",\n    description: \"Finalizing implementation roadmap\"\n  }];\n\n  // Handle input changes\n  const handleChange = (field, value) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n\n    // Clear error when field is updated\n    if (errors[field]) {\n      setErrors(prev => {\n        const newErrors = {\n          ...prev\n        };\n        delete newErrors[field];\n        return newErrors;\n      });\n    }\n  };\n\n  // Validate form\n  const validateForm = () => {\n    const newErrors = {};\n    if (!formData.companyName.trim()) {\n      newErrors.companyName = \"Company name is required\";\n    }\n    if (!formData.websiteUrl.trim()) {\n      newErrors.websiteUrl = \"Website URL is required\";\n    } else {\n      // Enhanced URL validation regex\n      // Checks for proper protocol, valid domain structure, and common TLDs\n      const urlRegex = /^(https?:\\/\\/)?(www\\.)?([a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}(\\/[a-zA-Z0-9-._~:/?#[\\]@!$&'()*+,;=]*)?$/;\n      if (!urlRegex.test(formData.websiteUrl)) {\n        newErrors.websiteUrl = \"Please enter a valid URL (e.g., https://example.com)\";\n      }\n    }\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  // Submit form\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!validateForm()) {\n      return;\n    }\n    setIsSubmitting(true);\n    try {\n      // Create a new CIA report\n      const response = await axios.post(\"/cia/reports\", {\n        name: `${formData.companyName} Intelligence Report`,\n        description: `CIA report for ${formData.companyName}`,\n        initialData: {\n          companyName: formData.companyName,\n          websiteUrl: formData.websiteUrl.startsWith('http') ? formData.websiteUrl : `https://${formData.websiteUrl}`,\n          keyPersonOfInfluence: formData.keyPersonOfInfluence ? {\n            name: formData.keyPersonOfInfluence,\n            role: \"Key Person of Influence\"\n          } : {},\n          primaryKeyword: formData.primaryKeyword\n        }\n      });\n\n      // Get the report ID\n      const {\n        id\n      } = response.data.report;\n      setReportId(id);\n      setIsSubmitted(true);\n      setReportStatus(\"processing\");\n\n      // Begin polling for status updates\n      startStatusPolling(id);\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error(\"Error submitting CIA report:\", error);\n      setErrors({\n        submit: ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || \"Failed to submit report. Please try again.\"\n      });\n      setIsSubmitting(false);\n    }\n  };\n\n  // Poll for report status updates\n  const startStatusPolling = id => {\n    const pollInterval = setInterval(async () => {\n      try {\n        const response = await axios.get(`/cia/reports/${id}/status`);\n        /* ------------------------------------------------------------------ */\n        /* ðŸ‘€  DEBUG LOGGING â€“ raw payload from server                       */\n        /* ------------------------------------------------------------------ */\n        console.log(\"[CIAWizard][poll] raw status payload â†’\", response.data);\n        const {\n          status,\n          progress,\n          currentPhase,\n          phaseProgress,\n          errors: reportErrors\n        } = response.data;\n\n        /* ------------------------------------------------------------------ */\n        /* ðŸ‘€  DEBUG LOGGING â€“ extracted primitives                          */\n        /* ------------------------------------------------------------------ */\n        console.log(`[CIAWizard][poll] status=${status}, progress=${progress},` + ` currentPhase=${currentPhase}, phaseProgress=${phaseProgress}`);\n        setReportStatus(status);\n        setReportProgress(progress);\n        if (currentPhase) {\n          setCurrentPhase(currentPhase);\n\n          // Update phase details\n          setPhaseDetails(prev => {\n            const updatedPhases = [...prev];\n            const phaseIndex = currentPhase - 1;\n\n            // Update current phase\n            if (!updatedPhases[phaseIndex]) {\n              updatedPhases[phaseIndex] = {\n                id: currentPhase,\n                progress: phaseProgress || 0,\n                status: \"processing\"\n              };\n            } else {\n              updatedPhases[phaseIndex] = {\n                ...updatedPhases[phaseIndex],\n                progress: phaseProgress || 0,\n                status: phaseProgress >= 100 ? \"completed\" : \"processing\"\n              };\n            }\n\n            // Mark all previous phases as completed\n            for (let i = 0; i < phaseIndex; i++) {\n              if (!updatedPhases[i]) {\n                updatedPhases[i] = {\n                  id: i + 1,\n                  progress: 100,\n                  status: \"completed\"\n                };\n              } else {\n                updatedPhases[i] = {\n                  ...updatedPhases[i],\n                  progress: 100,\n                  status: \"completed\"\n                };\n              }\n            }\n\n            // For failed reports, mark all subsequent phases as not started\n            if (status === \"failed\") {\n              for (let i = phaseIndex + 1; i < phases.length; i++) {\n                updatedPhases[i] = {\n                  id: i + 1,\n                  progress: 0,\n                  status: \"pending\"\n                };\n              }\n            }\n            return updatedPhases;\n          });\n\n          /* ---------------------------------------------------------------- */\n          /* ðŸ‘€  DEBUG LOGGING â€“ phaseDetails after local computation         */\n          /* ---------------------------------------------------------------- */\n          setPhaseDetails(prevState => {\n            console.log(\"[CIAWizard][poll] phaseDetails after update â†’\", prevState);\n            return prevState;\n          });\n        }\n\n        // If completed or failed, stop polling and fetch results\n        if (status === \"completed\" || status === \"failed\") {\n          clearInterval(pollInterval);\n          if (status === \"completed\") {\n            fetchReportResults(id);\n          } else if (status === \"failed\" && reportErrors && reportErrors.length > 0) {\n            // Display the error messages from the report\n            setErrors({\n              report: reportErrors.map(err => `${err.stage}: ${err.message}`).join(\", \")\n            });\n          }\n        }\n      } catch (error) {\n        console.error(\"Error polling report status:\", error);\n        // Don't stop polling on error, just log it\n      }\n    }, 3000); // Poll every 3 seconds\n\n    // Clean up interval on component unmount\n    return () => clearInterval(pollInterval);\n  };\n\n  // Fetch report results\n  const fetchReportResults = async id => {\n    try {\n      const response = await axios.get(`/cia/reports/${id}`);\n      setReportResults(response.data);\n    } catch (error) {\n      console.error(\"Error fetching report results:\", error);\n      setErrors({\n        results: \"Failed to fetch report results. Please try refreshing the page.\"\n      });\n    }\n  };\n\n  // Check if all phases are complete\n  const areAllPhasesComplete = () => {\n    // If we have fewer phase details than phases, some are missing\n    if (phaseDetails.length < phases.length) return false;\n\n    // Check if all phases have 100% progress\n    return phaseDetails.every(phase => phase && phase.progress === 100);\n  };\n\n  // Export report\n  const exportReport = async format => {\n    setExportLoading(prev => ({\n      ...prev,\n      [format]: true\n    }));\n    setExportError(null);\n    try {\n      console.log(`Starting export for format: ${format}, reportId: ${reportId}`);\n      const response = await axios.post(`/cia/reports/${reportId}/export`, {\n        format\n      });\n      if (!response.data || !response.data.exportUrl) {\n        throw new Error(`Export response missing URL for ${format} format`);\n      }\n      console.log(`Export successful, received URL: ${response.data.exportUrl}`);\n\n      // Construct the full URL if it's a relative path\n      let fullUrl = response.data.exportUrl;\n      if (fullUrl.startsWith('/')) {\n        // Get the base URL from the current window location\n        const baseUrl = `${window.location.protocol}//${window.location.host}`;\n        fullUrl = `${baseUrl}${fullUrl}`;\n        console.log(`Constructed full URL: ${fullUrl}`);\n      }\n\n      // Handle different export formats\n      if (format === \"pdf\") {\n        // For PDF, create a download link\n        console.log(`Creating download link for PDF: ${fullUrl}`);\n        const link = document.createElement(\"a\");\n        link.href = fullUrl;\n        link.download = `${formData.companyName}_CIA_Report.pdf`;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n      } else {\n        // For other formats, open in new tab\n        console.log(`Opening URL in new tab: ${fullUrl}`);\n        window.open(fullUrl, \"_blank\");\n      }\n    } catch (error) {\n      console.error(`Error exporting report as ${format}:`, error);\n\n      // Provide more detailed error information\n      let errorMessage = `Failed to export as ${format}. `;\n      if (error.response) {\n        var _error$response$data2;\n        // The request was made and the server responded with a status code\n        // that falls out of the range of 2xx\n        const statusCode = error.response.status;\n        const serverMessage = ((_error$response$data2 = error.response.data) === null || _error$response$data2 === void 0 ? void 0 : _error$response$data2.message) || 'Unknown server error';\n        errorMessage += `Server responded with status ${statusCode}: ${serverMessage}`;\n        console.error('Export error response:', error.response.data);\n      } else if (error.request) {\n        // The request was made but no response was received\n        errorMessage += 'No response received from server. Please check your connection.';\n      } else {\n        // Something happened in setting up the request that triggered an Error\n        errorMessage += error.message || 'Unknown error occurred';\n      }\n      setExportError(errorMessage);\n    } finally {\n      setExportLoading(prev => ({\n        ...prev,\n        [format]: false\n      }));\n    }\n  };\n\n  // Render form\n  const renderForm = () => /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"company-name\",\n          children: \"Company Name *\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"company-name\",\n          value: formData.companyName,\n          onChange: e => handleChange(\"companyName\", e.target.value),\n          placeholder: \"e.g. Acme Corporation\",\n          className: errors.companyName ? \"border-destructive\" : \"\",\n          disabled: isSubmitting\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 11\n        }, this), errors.companyName && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-destructive\",\n          children: errors.companyName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"website-url\",\n          children: \"Website URL *\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"website-url\",\n          value: formData.websiteUrl,\n          onChange: e => handleChange(\"websiteUrl\", e.target.value),\n          placeholder: \"e.g. https://www.example.com\",\n          className: errors.websiteUrl ? \"border-destructive\" : \"\",\n          disabled: isSubmitting\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 371,\n          columnNumber: 11\n        }, this), errors.websiteUrl && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-destructive\",\n          children: errors.websiteUrl\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"kpoi\",\n          children: \"Key Person of Influence (Optional)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"kpoi\",\n          value: formData.keyPersonOfInfluence,\n          onChange: e => handleChange(\"keyPersonOfInfluence\", e.target.value),\n          placeholder: \"e.g. John Smith, CEO\",\n          disabled: isSubmitting\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-muted-foreground\",\n          children: \"The main person associated with your brand\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 393,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"primary-keyword\",\n          children: \"Primary Keyword (Optional)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"primary-keyword\",\n          value: formData.primaryKeyword,\n          onChange: e => handleChange(\"primaryKeyword\", e.target.value),\n          placeholder: \"e.g. digital marketing services\",\n          disabled: isSubmitting\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-muted-foreground\",\n          children: \"Main keyword you want to rank for\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 9\n      }, this), errors.submit && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-3 bg-destructive/10 border border-destructive rounded-md\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-destructive flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n            className: \"h-4 w-4 mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 15\n          }, this), errors.submit]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 410,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-6\",\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        type: \"submit\",\n        className: \"w-full\",\n        disabled: isSubmitting,\n        children: isSubmitting ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Loader2, {\n            className: \"mr-2 h-4 w-4 animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 426,\n            columnNumber: 15\n          }, this), \"Submitting...\"]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [\"Generate CIA Report\", /*#__PURE__*/_jsxDEV(FileText, {\n            className: \"ml-2 h-4 w-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 419,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 352,\n    columnNumber: 5\n  }, this);\n\n  // Render progress\n  const renderProgress = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-medium\",\n        children: reportStatus === \"completed\" ? \"Your CIA Report is Ready!\" : reportStatus === \"failed\" ? \"Report Generation Failed\" : \"Generating Your CIA Report...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-sm text-muted-foreground\",\n        children: reportStatus === \"completed\" ? \"Your comprehensive marketing intelligence report has been generated. You can now export it in various formats.\" : reportStatus === \"failed\" ? \"There was an error generating your report. Please check the error details below.\" : \"Our AI is analyzing your company data across all 6 phases. This may take a few minutes.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 443,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-between text-sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Overall Progress\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 463,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [reportProgress, \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 464,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 462,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full bg-muted rounded-full h-2.5\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: cn(\"h-2.5 rounded-full\", reportStatus === \"completed\" ? \"bg-success\" : reportStatus === \"failed\" ? \"bg-destructive\" : \"bg-primary\"),\n          style: {\n            width: `${reportProgress}%`\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 466,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 461,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"text-sm font-medium\",\n        children: \"CIA Workflow Phases\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 480,\n        columnNumber: 9\n      }, this), phases.map((phase, index) => {\n        const phaseDetail = phaseDetails[index] || {\n          progress: 0,\n          status: index === currentPhase - 1 ? \"processing\" : \"pending\"\n        };\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-1\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between text-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"flex items-center\",\n              children: [phaseDetail.status === \"completed\" ? /*#__PURE__*/_jsxDEV(CheckCircle2, {\n                className: \"h-4 w-4 text-success mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 493,\n                columnNumber: 21\n              }, this) : phaseDetail.status === \"processing\" ? /*#__PURE__*/_jsxDEV(Loader2, {\n                className: \"h-4 w-4 text-primary mr-2 animate-spin\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 495,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-4 w-4 rounded-full border border-muted-foreground mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 497,\n                columnNumber: 21\n              }, this), phase.name]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 491,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [phaseDetail.progress, \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 501,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 490,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-full bg-muted rounded-full h-1.5\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: cn(\"h-1.5 rounded-full\", phaseDetail.status === \"completed\" ? \"bg-success\" : reportStatus === \"failed\" && index >= currentPhase ? \"bg-muted\" : \"bg-primary\"),\n              style: {\n                width: `${phaseDetail.progress}%`\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 504,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 503,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-muted-foreground\",\n            children: phase.description\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 513,\n            columnNumber: 15\n          }, this)]\n        }, phase.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 489,\n          columnNumber: 13\n        }, this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 7\n    }, this), reportStatus === \"failed\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-4 bg-destructive/10 border border-destructive rounded-md\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-start space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n          className: \"h-5 w-5 text-destructive mt-0.5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 523,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n            className: \"font-medium text-destructive\",\n            children: \"Report Generation Failed\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 525,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-muted-foreground mt-1\",\n            children: errors.report ? errors.report : \"There was an error generating your CIA report. Please try again or contact support for assistance.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 526,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"outline\",\n            className: \"mt-4\",\n            onClick: () => {\n              setIsSubmitted(false);\n              setReportStatus(\"idle\");\n              setReportProgress(0);\n              setCurrentPhase(0);\n              setPhaseDetails([]);\n              setReportResults(null);\n              setErrors({});\n            },\n            children: \"Try Again\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 529,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 524,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 522,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 521,\n      columnNumber: 9\n    }, this), reportStatus === \"completed\" && areAllPhasesComplete() && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4 pt-4 border-t\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"text-sm font-medium\",\n        children: \"Export Options\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 552,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col sm:flex-row gap-3\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outline\",\n          onClick: () => exportReport(\"pdf\"),\n          disabled: exportLoading.pdf,\n          className: \"flex-1\",\n          children: [exportLoading.pdf ? /*#__PURE__*/_jsxDEV(Loader2, {\n            className: \"mr-2 h-4 w-4 animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 562,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(Download, {\n            className: \"mr-2 h-4 w-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 564,\n            columnNumber: 17\n          }, this), \"Export as PDF\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outline\",\n          onClick: () => exportReport(\"google_sheets\"),\n          disabled: exportLoading.sheets,\n          className: \"flex-1\",\n          children: [exportLoading.sheets ? /*#__PURE__*/_jsxDEV(Loader2, {\n            className: \"mr-2 h-4 w-4 animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 576,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(FileSpreadsheet, {\n            className: \"mr-2 h-4 w-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 578,\n            columnNumber: 17\n          }, this), \"Export to Google Sheets\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 569,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outline\",\n          onClick: () => exportReport(\"notion\"),\n          disabled: exportLoading.notion,\n          className: \"flex-1\",\n          children: [exportLoading.notion ? /*#__PURE__*/_jsxDEV(Loader2, {\n            className: \"mr-2 h-4 w-4 animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 590,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(Database, {\n            className: \"mr-2 h-4 w-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 592,\n            columnNumber: 17\n          }, this), \"Export to Notion\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 583,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 554,\n        columnNumber: 11\n      }, this), exportError && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-3 bg-destructive/10 border border-destructive rounded-md\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-destructive flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n            className: \"h-4 w-4 mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 601,\n            columnNumber: 17\n          }, this), exportError]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 600,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 599,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 551,\n      columnNumber: 9\n    }, this), reportStatus === \"completed\" && reportResults && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4 pt-4 border-t\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"text-sm font-medium\",\n        children: \"Report Preview\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 612,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"border rounded-md p-4 bg-muted/50\",\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \"font-medium\",\n          children: reportResults.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 616,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-muted-foreground mt-1\",\n          children: reportResults.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 617,\n          columnNumber: 13\n        }, this), reportResults.phases && reportResults.phases.map(phase => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n            className: \"text-sm font-medium\",\n            children: phase.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 622,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-muted-foreground\",\n            children: phase.summary\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 623,\n            columnNumber: 17\n          }, this)]\n        }, phase.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 621,\n          columnNumber: 15\n        }, this)), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm mt-4\",\n          children: \"For the complete report with all insights and recommendations, please use one of the export options above.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 627,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 615,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 611,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 442,\n    columnNumber: 5\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mx-auto py-8 px-4 md:px-6\",\n    children: /*#__PURE__*/_jsxDEV(Card, {\n      className: \"w-full max-w-4xl mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n        children: [/*#__PURE__*/_jsxDEV(CardTitle, {\n          className: \"flex items-center\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"gradient-text\",\n            children: \"CIA Wizard\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 641,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 640,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CardDescription, {\n          children: \"The Colossal Intelligence Arsenal will gather and process data to create your \\\"Master Content Bible\\\"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 643,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 639,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n        children: isSubmitted ? renderProgress() : renderForm()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 648,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CardFooter, {\n        className: \"flex justify-between\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-muted-foreground\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(Building2, {\n              className: \"h-3 w-3 mr-1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 655,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: formData.companyName || \"Your Company\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 656,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 654,\n            columnNumber: 13\n          }, this), formData.websiteUrl && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center mt-1\",\n            children: [/*#__PURE__*/_jsxDEV(Globe, {\n              className: \"h-3 w-3 mr-1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 660,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: formData.websiteUrl\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 661,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 659,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 653,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 652,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 638,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 637,\n    columnNumber: 5\n  }, this);\n};\n_s(CIAWizard, \"Sals+1X23eLodZG/F9kedxnuYRY=\");\n_c = CIAWizard;\nexport default CIAWizard;\nvar _c;\n$RefreshReg$(_c, \"CIAWizard\");","map":{"version":3,"names":["React","useState","useEffect","axios","CheckCircle2","AlertCircle","Building2","Globe","FileText","Download","FileSpreadsheet","Database","Loader2","Button","Input","Label","Card","CardHeader","CardTitle","CardDescription","CardContent","CardFooter","cn","jsxDEV","_jsxDEV","Fragment","_Fragment","CIAWizard","_s","formData","setFormData","companyName","websiteUrl","keyPersonOfInfluence","primaryKeyword","isSubmitting","setIsSubmitting","isSubmitted","setIsSubmitted","errors","setErrors","reportId","setReportId","reportStatus","setReportStatus","reportProgress","setReportProgress","currentPhase","setCurrentPhase","phaseDetails","setPhaseDetails","reportResults","setReportResults","exportLoading","setExportLoading","pdf","sheets","notion","exportError","setExportError","phases","id","name","description","handleChange","field","value","prev","newErrors","validateForm","trim","urlRegex","test","Object","keys","length","handleSubmit","e","preventDefault","response","post","initialData","startsWith","role","data","report","startStatusPolling","error","_error$response","_error$response$data","console","submit","message","pollInterval","setInterval","get","log","status","progress","phaseProgress","reportErrors","updatedPhases","phaseIndex","i","prevState","clearInterval","fetchReportResults","map","err","stage","join","results","areAllPhasesComplete","every","phase","exportReport","format","exportUrl","Error","fullUrl","baseUrl","window","location","protocol","host","link","document","createElement","href","download","body","appendChild","click","removeChild","open","errorMessage","_error$response$data2","statusCode","serverMessage","request","renderForm","onSubmit","children","className","htmlFor","fileName","_jsxFileName","lineNumber","columnNumber","onChange","target","placeholder","disabled","type","renderProgress","style","width","index","phaseDetail","variant","onClick","summary","_c","$RefreshReg$"],"sources":["/Users/rodericandrews/Factory-ai/waterfall-app/client/src/components/CIA/CIAWizard.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"../../utils/axios\";\nimport { \n  CheckCircle2, \n  AlertCircle, \n  Building2, \n  Globe,\n  FileText,\n  Download,\n  FileSpreadsheet,\n  Database,\n  Loader2\n} from \"lucide-react\";\n\n// Import shadcn/ui components\nimport { Button } from \"../ui/button\";\nimport { Input } from \"../ui/input\";\nimport { Label } from \"../ui/label\";\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent, CardFooter } from \"../ui/card\";\n\n// Utility functions\nimport { cn } from \"../../lib/utils\";\n\n/**\n * CIA Wizard - Simplified form for gathering company intelligence data\n * Collects minimal information needed to generate a comprehensive marketing intelligence report\n */\nconst CIAWizard = () => {\n  // Form state\n  const [formData, setFormData] = useState({\n    companyName: \"\",\n    websiteUrl: \"\",\n    keyPersonOfInfluence: \"\",\n    primaryKeyword: \"\"\n  });\n  \n  // Submission state\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isSubmitted, setIsSubmitted] = useState(false);\n  const [errors, setErrors] = useState({});\n  \n  // Report state\n  const [reportId, setReportId] = useState(null);\n  const [reportStatus, setReportStatus] = useState(\"idle\"); // idle, processing, completed, failed\n  const [reportProgress, setReportProgress] = useState(0);\n  const [currentPhase, setCurrentPhase] = useState(0);\n  const [phaseDetails, setPhaseDetails] = useState([]);\n  const [reportResults, setReportResults] = useState(null);\n  const [exportLoading, setExportLoading] = useState({\n    pdf: false,\n    sheets: false,\n    notion: false\n  });\n  const [exportError, setExportError] = useState(null);\n\n  // CIA workflow phases\n  const phases = [\n    { id: 1, name: \"Business Intelligence\", description: \"Analyzing company data and market position\" },\n    { id: 2, name: \"SEO & Social Intelligence\", description: \"Researching keywords and competitive landscape\" },\n    { id: 3, name: \"Strategic Synthesis\", description: \"Combining insights for strategic recommendations\" },\n    { id: 4, name: \"Golden Hippo Offer\", description: \"Developing tiered pricing and value stacks\" },\n    { id: 5, name: \"Convergence Blender\", description: \"Creating 12-week content calendar\" },\n    { id: 6, name: \"Master Content Bible\", description: \"Finalizing implementation roadmap\" }\n  ];\n\n  // Handle input changes\n  const handleChange = (field, value) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n    \n    // Clear error when field is updated\n    if (errors[field]) {\n      setErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[field];\n        return newErrors;\n      });\n    }\n  };\n\n  // Validate form\n  const validateForm = () => {\n    const newErrors = {};\n    \n    if (!formData.companyName.trim()) {\n      newErrors.companyName = \"Company name is required\";\n    }\n    \n    if (!formData.websiteUrl.trim()) {\n      newErrors.websiteUrl = \"Website URL is required\";\n    } else {\n      // Enhanced URL validation regex\n      // Checks for proper protocol, valid domain structure, and common TLDs\n      const urlRegex = /^(https?:\\/\\/)?(www\\.)?([a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}(\\/[a-zA-Z0-9-._~:/?#[\\]@!$&'()*+,;=]*)?$/;\n      if (!urlRegex.test(formData.websiteUrl)) {\n        newErrors.websiteUrl = \"Please enter a valid URL (e.g., https://example.com)\";\n      }\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  // Submit form\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n    \n    setIsSubmitting(true);\n    \n    try {\n      // Create a new CIA report\n      const response = await axios.post(\"/cia/reports\", {\n        name: `${formData.companyName} Intelligence Report`,\n        description: `CIA report for ${formData.companyName}`,\n        initialData: {\n          companyName: formData.companyName,\n          websiteUrl: formData.websiteUrl.startsWith('http') ? formData.websiteUrl : `https://${formData.websiteUrl}`,\n          keyPersonOfInfluence: formData.keyPersonOfInfluence ? {\n            name: formData.keyPersonOfInfluence,\n            role: \"Key Person of Influence\"\n          } : {},\n          primaryKeyword: formData.primaryKeyword\n        }\n      });\n      \n      // Get the report ID\n      const { id } = response.data.report;\n      setReportId(id);\n      setIsSubmitted(true);\n      setReportStatus(\"processing\");\n      \n      // Begin polling for status updates\n      startStatusPolling(id);\n    } catch (error) {\n      console.error(\"Error submitting CIA report:\", error);\n      setErrors({\n        submit: error.response?.data?.message || \"Failed to submit report. Please try again.\"\n      });\n      setIsSubmitting(false);\n    }\n  };\n\n  // Poll for report status updates\n  const startStatusPolling = (id) => {\n    const pollInterval = setInterval(async () => {\n      try {\n        const response = await axios.get(`/cia/reports/${id}/status`);\n        /* ------------------------------------------------------------------ */\n        /* ðŸ‘€  DEBUG LOGGING â€“ raw payload from server                       */\n        /* ------------------------------------------------------------------ */\n        console.log(\"[CIAWizard][poll] raw status payload â†’\", response.data);\n\n        const { status, progress, currentPhase, phaseProgress, errors: reportErrors } = response.data;\n\n        /* ------------------------------------------------------------------ */\n        /* ðŸ‘€  DEBUG LOGGING â€“ extracted primitives                          */\n        /* ------------------------------------------------------------------ */\n        console.log(\n          `[CIAWizard][poll] status=${status}, progress=${progress},` +\n          ` currentPhase=${currentPhase}, phaseProgress=${phaseProgress}`\n        );\n        \n        setReportStatus(status);\n        setReportProgress(progress);\n        \n        if (currentPhase) {\n          setCurrentPhase(currentPhase);\n          \n          // Update phase details\n          setPhaseDetails(prev => {\n            const updatedPhases = [...prev];\n            const phaseIndex = currentPhase - 1;\n            \n            // Update current phase\n            if (!updatedPhases[phaseIndex]) {\n              updatedPhases[phaseIndex] = {\n                id: currentPhase,\n                progress: phaseProgress || 0,\n                status: \"processing\"\n              };\n            } else {\n              updatedPhases[phaseIndex] = {\n                ...updatedPhases[phaseIndex],\n                progress: phaseProgress || 0,\n                status: phaseProgress >= 100 ? \"completed\" : \"processing\"\n              };\n            }\n\n            // Mark all previous phases as completed\n            for (let i = 0; i < phaseIndex; i++) {\n              if (!updatedPhases[i]) {\n                updatedPhases[i] = {\n                  id: i + 1,\n                  progress: 100,\n                  status: \"completed\"\n                };\n              } else {\n                updatedPhases[i] = {\n                  ...updatedPhases[i],\n                  progress: 100,\n                  status: \"completed\"\n                };\n              }\n            }\n            \n            // For failed reports, mark all subsequent phases as not started\n            if (status === \"failed\") {\n              for (let i = phaseIndex + 1; i < phases.length; i++) {\n                updatedPhases[i] = {\n                  id: i + 1,\n                  progress: 0,\n                  status: \"pending\"\n                };\n              }\n            }\n            \n            return updatedPhases;\n          });\n\n          /* ---------------------------------------------------------------- */\n          /* ðŸ‘€  DEBUG LOGGING â€“ phaseDetails after local computation         */\n          /* ---------------------------------------------------------------- */\n          setPhaseDetails(prevState => {\n            console.log(\"[CIAWizard][poll] phaseDetails after update â†’\", prevState);\n            return prevState;\n          });\n        }\n        \n        // If completed or failed, stop polling and fetch results\n        if (status === \"completed\" || status === \"failed\") {\n          clearInterval(pollInterval);\n          \n          if (status === \"completed\") {\n            fetchReportResults(id);\n          } else if (status === \"failed\" && reportErrors && reportErrors.length > 0) {\n            // Display the error messages from the report\n            setErrors({\n              report: reportErrors.map(err => `${err.stage}: ${err.message}`).join(\", \")\n            });\n          }\n        }\n      } catch (error) {\n        console.error(\"Error polling report status:\", error);\n        // Don't stop polling on error, just log it\n      }\n    }, 3000); // Poll every 3 seconds\n    \n    // Clean up interval on component unmount\n    return () => clearInterval(pollInterval);\n  };\n\n  // Fetch report results\n  const fetchReportResults = async (id) => {\n    try {\n      const response = await axios.get(`/cia/reports/${id}`);\n      setReportResults(response.data);\n    } catch (error) {\n      console.error(\"Error fetching report results:\", error);\n      setErrors({\n        results: \"Failed to fetch report results. Please try refreshing the page.\"\n      });\n    }\n  };\n\n  // Check if all phases are complete\n  const areAllPhasesComplete = () => {\n    // If we have fewer phase details than phases, some are missing\n    if (phaseDetails.length < phases.length) return false;\n    \n    // Check if all phases have 100% progress\n    return phaseDetails.every(phase => phase && phase.progress === 100);\n  };\n\n  // Export report\n  const exportReport = async (format) => {\n    setExportLoading(prev => ({ ...prev, [format]: true }));\n    setExportError(null);\n    \n    try {\n      console.log(`Starting export for format: ${format}, reportId: ${reportId}`);\n      \n      const response = await axios.post(`/cia/reports/${reportId}/export`, {\n        format\n      });\n      \n      if (!response.data || !response.data.exportUrl) {\n        throw new Error(`Export response missing URL for ${format} format`);\n      }\n      \n      console.log(`Export successful, received URL: ${response.data.exportUrl}`);\n      \n      // Construct the full URL if it's a relative path\n      let fullUrl = response.data.exportUrl;\n      if (fullUrl.startsWith('/')) {\n        // Get the base URL from the current window location\n        const baseUrl = `${window.location.protocol}//${window.location.host}`;\n        fullUrl = `${baseUrl}${fullUrl}`;\n        console.log(`Constructed full URL: ${fullUrl}`);\n      }\n      \n      // Handle different export formats\n      if (format === \"pdf\") {\n        // For PDF, create a download link\n        console.log(`Creating download link for PDF: ${fullUrl}`);\n        const link = document.createElement(\"a\");\n        link.href = fullUrl;\n        link.download = `${formData.companyName}_CIA_Report.pdf`;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n      } else {\n        // For other formats, open in new tab\n        console.log(`Opening URL in new tab: ${fullUrl}`);\n        window.open(fullUrl, \"_blank\");\n      }\n    } catch (error) {\n      console.error(`Error exporting report as ${format}:`, error);\n      \n      // Provide more detailed error information\n      let errorMessage = `Failed to export as ${format}. `;\n      \n      if (error.response) {\n        // The request was made and the server responded with a status code\n        // that falls out of the range of 2xx\n        const statusCode = error.response.status;\n        const serverMessage = error.response.data?.message || 'Unknown server error';\n        \n        errorMessage += `Server responded with status ${statusCode}: ${serverMessage}`;\n        console.error('Export error response:', error.response.data);\n      } else if (error.request) {\n        // The request was made but no response was received\n        errorMessage += 'No response received from server. Please check your connection.';\n      } else {\n        // Something happened in setting up the request that triggered an Error\n        errorMessage += error.message || 'Unknown error occurred';\n      }\n      \n      setExportError(errorMessage);\n    } finally {\n      setExportLoading(prev => ({ ...prev, [format]: false }));\n    }\n  };\n\n  // Render form\n  const renderForm = () => (\n    <form onSubmit={handleSubmit}>\n      <div className=\"space-y-4\">\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"company-name\">Company Name *</Label>\n          <Input\n            id=\"company-name\"\n            value={formData.companyName}\n            onChange={(e) => handleChange(\"companyName\", e.target.value)}\n            placeholder=\"e.g. Acme Corporation\"\n            className={errors.companyName ? \"border-destructive\" : \"\"}\n            disabled={isSubmitting}\n          />\n          {errors.companyName && (\n            <p className=\"text-sm text-destructive\">{errors.companyName}</p>\n          )}\n        </div>\n        \n        <div className=\"space-y-2\">\n          <Label htmlFor=\"website-url\">Website URL *</Label>\n          <Input\n            id=\"website-url\"\n            value={formData.websiteUrl}\n            onChange={(e) => handleChange(\"websiteUrl\", e.target.value)}\n            placeholder=\"e.g. https://www.example.com\"\n            className={errors.websiteUrl ? \"border-destructive\" : \"\"}\n            disabled={isSubmitting}\n          />\n          {errors.websiteUrl && (\n            <p className=\"text-sm text-destructive\">{errors.websiteUrl}</p>\n          )}\n        </div>\n        \n        <div className=\"space-y-2\">\n          <Label htmlFor=\"kpoi\">Key Person of Influence (Optional)</Label>\n          <Input\n            id=\"kpoi\"\n            value={formData.keyPersonOfInfluence}\n            onChange={(e) => handleChange(\"keyPersonOfInfluence\", e.target.value)}\n            placeholder=\"e.g. John Smith, CEO\"\n            disabled={isSubmitting}\n          />\n          <p className=\"text-xs text-muted-foreground\">The main person associated with your brand</p>\n        </div>\n        \n        <div className=\"space-y-2\">\n          <Label htmlFor=\"primary-keyword\">Primary Keyword (Optional)</Label>\n          <Input\n            id=\"primary-keyword\"\n            value={formData.primaryKeyword}\n            onChange={(e) => handleChange(\"primaryKeyword\", e.target.value)}\n            placeholder=\"e.g. digital marketing services\"\n            disabled={isSubmitting}\n          />\n          <p className=\"text-xs text-muted-foreground\">Main keyword you want to rank for</p>\n        </div>\n        \n        {errors.submit && (\n          <div className=\"p-3 bg-destructive/10 border border-destructive rounded-md\">\n            <p className=\"text-sm text-destructive flex items-center\">\n              <AlertCircle className=\"h-4 w-4 mr-2\" />\n              {errors.submit}\n            </p>\n          </div>\n        )}\n      </div>\n      \n      <div className=\"mt-6\">\n        <Button \n          type=\"submit\" \n          className=\"w-full\" \n          disabled={isSubmitting}\n        >\n          {isSubmitting ? (\n            <>\n              <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n              Submitting...\n            </>\n          ) : (\n            <>\n              Generate CIA Report\n              <FileText className=\"ml-2 h-4 w-4\" />\n            </>\n          )}\n        </Button>\n      </div>\n    </form>\n  );\n\n  // Render progress\n  const renderProgress = () => (\n    <div className=\"space-y-6\">\n      <div className=\"space-y-2\">\n        <h3 className=\"text-lg font-medium\">\n          {reportStatus === \"completed\" \n            ? \"Your CIA Report is Ready!\" \n            : reportStatus === \"failed\"\n            ? \"Report Generation Failed\"\n            : \"Generating Your CIA Report...\"}\n        </h3>\n        <p className=\"text-sm text-muted-foreground\">\n          {reportStatus === \"completed\"\n            ? \"Your comprehensive marketing intelligence report has been generated. You can now export it in various formats.\"\n            : reportStatus === \"failed\"\n            ? \"There was an error generating your report. Please check the error details below.\"\n            : \"Our AI is analyzing your company data across all 6 phases. This may take a few minutes.\"}\n        </p>\n      </div>\n      \n      {/* Overall progress */}\n      <div className=\"space-y-2\">\n        <div className=\"flex justify-between text-sm\">\n          <span>Overall Progress</span>\n          <span>{reportProgress}%</span>\n        </div>\n        <div className=\"w-full bg-muted rounded-full h-2.5\">\n          <div\n            className={cn(\n              \"h-2.5 rounded-full\",\n              reportStatus === \"completed\" ? \"bg-success\" : \n              reportStatus === \"failed\" ? \"bg-destructive\" : \"bg-primary\"\n            )}\n            style={{ width: `${reportProgress}%` }}\n          ></div>\n        </div>\n      </div>\n      \n      {/* Phase progress */}\n      <div className=\"space-y-4\">\n        <h4 className=\"text-sm font-medium\">CIA Workflow Phases</h4>\n        \n        {phases.map((phase, index) => {\n          const phaseDetail = phaseDetails[index] || { \n            progress: 0, \n            status: index === currentPhase - 1 ? \"processing\" : \"pending\" \n          };\n          \n          return (\n            <div key={phase.id} className=\"space-y-1\">\n              <div className=\"flex justify-between text-sm\">\n                <span className=\"flex items-center\">\n                  {phaseDetail.status === \"completed\" ? (\n                    <CheckCircle2 className=\"h-4 w-4 text-success mr-2\" />\n                  ) : phaseDetail.status === \"processing\" ? (\n                    <Loader2 className=\"h-4 w-4 text-primary mr-2 animate-spin\" />\n                  ) : (\n                    <div className=\"h-4 w-4 rounded-full border border-muted-foreground mr-2\" />\n                  )}\n                  {phase.name}\n                </span>\n                <span>{phaseDetail.progress}%</span>\n              </div>\n              <div className=\"w-full bg-muted rounded-full h-1.5\">\n                <div\n                  className={cn(\n                    \"h-1.5 rounded-full\",\n                    phaseDetail.status === \"completed\" ? \"bg-success\" : \n                    reportStatus === \"failed\" && index >= currentPhase ? \"bg-muted\" : \"bg-primary\"\n                  )}\n                  style={{ width: `${phaseDetail.progress}%` }}\n                ></div>\n              </div>\n              <p className=\"text-xs text-muted-foreground\">{phase.description}</p>\n            </div>\n          );\n        })}\n      </div>\n      \n      {/* Error message (visible when failed) */}\n      {reportStatus === \"failed\" && (\n        <div className=\"p-4 bg-destructive/10 border border-destructive rounded-md\">\n          <div className=\"flex items-start space-x-2\">\n            <AlertCircle className=\"h-5 w-5 text-destructive mt-0.5\" />\n            <div>\n              <h5 className=\"font-medium text-destructive\">Report Generation Failed</h5>\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                {errors.report ? errors.report : \"There was an error generating your CIA report. Please try again or contact support for assistance.\"}\n              </p>\n              <Button \n                variant=\"outline\" \n                className=\"mt-4\" \n                onClick={() => {\n                  setIsSubmitted(false);\n                  setReportStatus(\"idle\");\n                  setReportProgress(0);\n                  setCurrentPhase(0);\n                  setPhaseDetails([]);\n                  setReportResults(null);\n                  setErrors({});\n                }}\n              >\n                Try Again\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Export options (visible when completed AND all phases are at 100%) */}\n      {reportStatus === \"completed\" && areAllPhasesComplete() && (\n        <div className=\"space-y-4 pt-4 border-t\">\n          <h4 className=\"text-sm font-medium\">Export Options</h4>\n          \n          <div className=\"flex flex-col sm:flex-row gap-3\">\n            <Button \n              variant=\"outline\" \n              onClick={() => exportReport(\"pdf\")}\n              disabled={exportLoading.pdf}\n              className=\"flex-1\"\n            >\n              {exportLoading.pdf ? (\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n              ) : (\n                <Download className=\"mr-2 h-4 w-4\" />\n              )}\n              Export as PDF\n            </Button>\n            \n            <Button \n              variant=\"outline\" \n              onClick={() => exportReport(\"google_sheets\")}\n              disabled={exportLoading.sheets}\n              className=\"flex-1\"\n            >\n              {exportLoading.sheets ? (\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n              ) : (\n                <FileSpreadsheet className=\"mr-2 h-4 w-4\" />\n              )}\n              Export to Google Sheets\n            </Button>\n            \n            <Button \n              variant=\"outline\" \n              onClick={() => exportReport(\"notion\")}\n              disabled={exportLoading.notion}\n              className=\"flex-1\"\n            >\n              {exportLoading.notion ? (\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n              ) : (\n                <Database className=\"mr-2 h-4 w-4\" />\n              )}\n              Export to Notion\n            </Button>\n          </div>\n          \n          {exportError && (\n            <div className=\"p-3 bg-destructive/10 border border-destructive rounded-md\">\n              <p className=\"text-sm text-destructive flex items-center\">\n                <AlertCircle className=\"h-4 w-4 mr-2\" />\n                {exportError}\n              </p>\n            </div>\n          )}\n        </div>\n      )}\n      \n      {/* Results preview (visible when completed) */}\n      {reportStatus === \"completed\" && reportResults && (\n        <div className=\"space-y-4 pt-4 border-t\">\n          <h4 className=\"text-sm font-medium\">Report Preview</h4>\n          \n          {/* This would be expanded with actual report data visualization */}\n          <div className=\"border rounded-md p-4 bg-muted/50\">\n            <h5 className=\"font-medium\">{reportResults.name}</h5>\n            <p className=\"text-sm text-muted-foreground mt-1\">{reportResults.description}</p>\n            \n            {/* Example of displaying some report data */}\n            {reportResults.phases && reportResults.phases.map((phase) => (\n              <div key={phase.id} className=\"mt-4\">\n                <h6 className=\"text-sm font-medium\">{phase.name}</h6>\n                <p className=\"text-xs text-muted-foreground\">{phase.summary}</p>\n              </div>\n            ))}\n            \n            <p className=\"text-sm mt-4\">\n              For the complete report with all insights and recommendations, please use one of the export options above.\n            </p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n\n  return (\n    <div className=\"container mx-auto py-8 px-4 md:px-6\">\n      <Card className=\"w-full max-w-4xl mx-auto\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center\">\n            <span className=\"gradient-text\">CIA Wizard</span>\n          </CardTitle>\n          <CardDescription>\n            The Colossal Intelligence Arsenal will gather and process data to create your \"Master Content Bible\"\n          </CardDescription>\n        </CardHeader>\n        \n        <CardContent>\n          {isSubmitted ? renderProgress() : renderForm()}\n        </CardContent>\n        \n        <CardFooter className=\"flex justify-between\">\n          <div className=\"text-xs text-muted-foreground\">\n            <div className=\"flex items-center\">\n              <Building2 className=\"h-3 w-3 mr-1\" />\n              <span>{formData.companyName || \"Your Company\"}</span>\n            </div>\n            {formData.websiteUrl && (\n              <div className=\"flex items-center mt-1\">\n                <Globe className=\"h-3 w-3 mr-1\" />\n                <span>{formData.websiteUrl}</span>\n              </div>\n            )}\n          </div>\n        </CardFooter>\n      </Card>\n    </div>\n  );\n};\n\nexport default CIAWizard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}